# components of Azure Cosmos DB for NoSQL?
* <ins>Accounts</ins> - fundamental units of distribution and high availability. At the account level, configure the region[s] for your data & set the default consistency level for requests. Accounts also contain the globally unique DNS name used for API requests. 
* <ins>Databases</ins> -  Each account can contain one or more Databases. A database is a logical unit of management for containers
* <ins>Containers</ins> - fundamental unit of scalability. At the container level, provision throughput and Optionally configure an indexing policy or a default time-to-live value. Cosmos will automatically and transparently partition the data in a container.
* <ins>Items</ins> - The NoSQL API for stores individual documents in JSON format as items within the container. Cosmos can provide fast and predictable performance because write operations on JSON documents are atomic.
* ![](img/2/3-item-hierarchy.png)
* Partitioning & Partition Keys
    1. Partitioning involves writing data to servers in a way that optimizes both reads and writes.
    2. Cosmos DB stores data in virtual buckets called logical partitions.
    3. It relies on a partition key to determine which of these buckets to put new data in and where to look for data during a query. 
    * ![](img/2/create_key.PNG)
    * ![](img/2/partition_key.PNG)
    4. When choosing a key, following three guidelines.
        1. Find the write balance - Test your partition key to see how it distributes writes. Avoid hotspots and rate limits by achieving even distribution of storage and throughput across logical partitions.
        2. Aim for a single partition query. Look to see how many partitions get hit when you run your most frequent queries. Aoid the cost and latency of involving multiple partitions, by choosing a key that queries a single partition.
        * ![image](https://github.com/mkader/Developer-Tools/assets/3132680/601d6081-3aed-4428-98e7-0095c5ab2113)
        * ![image](https://github.com/mkader/Developer-Tools/assets/3132680/1bc3fe85-b71b-4cc1-8f69-d41ee1e41404)
        3. Understand cross-partition query trade offs. If you do run cross-partition queries for less important workloads every once in a while, it won't impact your overall experience. But if it's more than that, you can use an array of discrete values for the partition keys in your query to target a subset of partitions.
        * ![image](https://github.com/mkader/Developer-Tools/assets/3132680/d3030a58-1b10-4d20-97a3-fcdf76fcaeb4)
        * ![image](https://github.com/mkader/Developer-Tools/assets/3132680/e17ab35d-a944-49b2-98d6-39c81642c3b4)
    5. Every container is required to specify a partition key path. Behind the scenes, Cosmos uses this path to logically partition data using partition key values. For example, consider the following JSON document:
            ``` mark
            {
              "id": "35b5bf7d-5f0e-4209-b7cb-8c5c70c3bb59",
              "deviceDisplayName": "shared-printer",
              "acquiredYear": 2019,
              "department": {
                "name": "information-technology",
                "metadata": {
                  "location": "floor-5-unit-27"
                }
              },
              "queuedDocuments": [
                {
                  "sender": "user-293749329",
                  "sentTime": "2019-07-26T05:12:37",
                  "pages": 5,
                  "spoolRef": "3f4b759c-3230-4269-a88e-de7620ad91c0"
                },
                {
                  "device": {
                    "type": "mobile"
                  },
                  "sentTime": "2019-11-12T13:08:42",
                  "spoolRefs": [
                    "6a86682c-be5a-4a4a-bacd-96c4d1c7ece6",
                    "79e78fe2-93aa-4688-89db-a7278b034aa6"
                  ]
                }
              ]
            }
            ```
        1. container specifies a partition key path of /department/name, then the partition key value of this document would be information-technology. Behind the scenes, CosmosL automatically manages the physical resources necessary to support your data workload.
